{
    "create_vendor_summary_table": "with FreightSummary as (select VendorNumber, sum(Freight) as TotalFreight from vendor_invoice group by VendorNumber), PurchaseSummary as (select p.VendorName, p.VendorNumber, p.Description, p.Brand, p.purchasePrice, ps.Price as ActualPrice, ps.Volume, sum(p.Quantity) as TotalQuantityPurchased, sum(p.Dollars) as TotalDollarsPurchased from purchases p join purchase_prices ps on p.brand=ps.brand where p.purchasePrice>0 group by p.VendorNumber, p.VendorName, p.Brand,p.Description,p.PurchasePrice,ps.price,ps.Volume), SalesSummary as (select VendorNo, VendorName, Brand, sum(SalesPrice) as TotalSalesPrice, sum(SalesQuantity) as TotalQuantitySold, sum(ExciseTax) as TotalExciseTax, sum(SalesDollars) as TotalSalesDollars from sales group by VendorNo,Brand) select ps.VendorNumber, ps.VendorName, ps.Brand, ps.Description, ps.ActualPrice, ps.PurchasePrice, ps.Volume, s.TotalQuantitySold, s.TotalSalesDollars, s.TotalExciseTax, s.TotalSalesPrice, ps.TotalQuantityPurchased, ps.TotalDollarsPurchased, vi.TotalFreight from PurchaseSummary ps left join SalesSummary s on ps.VendorNumber=s.VendorNo and ps.Brand=s.Brand left join FreightSummary vi on ps.VendorNumber=vi.VendorNumber order by ps.TotalDollarsPurchased desc"
}